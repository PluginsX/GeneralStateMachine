<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通用状态机系统</title>
    <!-- 标准ICO格式作为回退 -->
    <link rel="icon" href="./assets/images/favicon.ico" sizes="any">
    <!-- SVG格式（现代浏览器支持） -->
    <link rel="icon" href="./assets/images/favicon.svg" type="image/svg+xml">
    <!-- Apple设备支持 -->
    <link rel="apple-touch-icon" href="./assets/images/apple-touch-icon.png">
    <!-- Safari pinned tab -->
    <link rel="mask-icon" href="./assets/images/safari.svg" color="#1454ec">
    <link rel="stylesheet" href="./assets/styles/global.css">
    <!-- 新的属性面板样式 -->
    <link rel="stylesheet" href="../src/ui/propertyPanel/styles/propertyPanel.css">
    <link rel="stylesheet" href="../src/ui/propertyPanel/styles/theme.css">
    <script src="../src/lib/d3.v7.min.js"></script>
</head>

<body>
    <!-- 欢迎页面 -->
    <div id="welcome-screen">
        <div class="welcome-container">
            <div class="welcome-title">通用状态机系统</div>
            
            <div class="welcome-actions">
                <button id="welcome-new-project" class="action-button primary">新建工程</button>
                <button id="welcome-open-project" class="action-button secondary">打开工程</button>
            </div>
            
            <div class="welcome-section">
                <h3>📂 演示项目工程</h3>
                <div class="file-list" id="project-files-list">
                    <!-- 演示项目文件列表将通过JavaScript动态添加 -->
                </div>
            </div>
            
            <div class="welcome-section">
                <h3>📄 演示导入文件</h3>
                <div class="file-list" id="import-files-list">
                    <!-- 演示导入文件列表将通过JavaScript动态添加 -->
                </div>
            </div>
            
            <div class="welcome-footer">
                <p>选择一个演示项目或导入文件开始使用</p>
            </div>
        </div>
    </div>

    <!-- 顶部菜单栏 -->
    <div class="menu-bar">
        <div class="menu-group">
            <!-- 文件菜单 -->
            <div class="export-submenu">
                <button id="file-menu">文件</button>
                <div class="export-submenu-content">
                    <button id="new-project">新建工程</button>
                    <button id="open-project">打开工程</button>
                    <button id="save-project">保存工程</button>
                </div>
            </div>
            <!-- 设置菜单 -->
            <div class="export-submenu">
                <button id="settings-menu">设置</button>
                <div class="export-submenu-content">
                    <button id="Hotkey-settings">热键设置</button>
                    <!-- <button id="Style-settings">配色设置</button>
                    <button id="Layout-settings">布局设置</button> -->
                </div>
            </div>
            <!-- 工具菜单 -->
            <div class="export-submenu">
                <button id="tools-menu">工具</button>
                <div class="export-submenu-content">
                    <!-- 导入子菜单 -->
                    <div class="export-submenu">
                        <button id="import-menu">导入</button>
                        <div class="export-submenu-content">
                            <button id="import-md">Markdown</button>
                            <button id="import-json">Json</button>
                            <button id="import-yaml">YAML</button>
                        </div>
                    </div>
                    
                    <!-- 导出子菜单 -->
                    <div class="export-submenu">
                        <button id="export-menu">导出</button>
                        <div class="export-submenu-content">
                            <button id="export-md">Markdown</button>
                            <button id="export-image">Image</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <select id="selection-filter" class="selection-filter">
                <option value="all">选择所有对象</option>
                <option value="nodes">仅选择节点</option>
                <option value="connections">仅选择连线</option>
            </select>
        </div>
        <div class="menu-group">
            <button id="undo">撤销</button>
            <button id="redo">重做</button>
            <button id="toggle-theme">切换主题</button>
        </div>
    </div>

    <!-- 主内容区 -->
    <div class="main-content">
        <!-- 左侧工具栏 -->
        <aside class="tool-panel">
            <!-- 工具卷展栏 -->
            <div class="collapsible-section">
                <div class="collapsible-header" id="tools-header">
                    <span class="collapsible-title">工具</span>
                    <span class="collapsible-icon">▼</span>
                </div>
                <div class="collapsible-content" id="tools-content">
                    <button id="merge-nodes-btn" class="toolbar-btn">合并节点</button>
                    <button id="merge-conditions-btn" class="toolbar-btn">合并条件</button>
                    <button id="remove-duplicate-connections-btn" class="toolbar-btn">删除重复连接</button>
                    <button id="auto-arrange-btn" class="toolbar-btn">自动排列</button>
                    <button id="real-time-arrange" class="toolbar-btn">实时自动排列</button>
                    <button id="concentrate-arrange-btn" class="toolbar-btn">集中排列</button>
                    
                </div>
            </div>
            
            <!-- 对象卷展栏 -->
            <div class="collapsible-section">
                <div class="collapsible-header" id="objects-header">
                    <span class="collapsible-title">对象</span>
                    <span class="collapsible-icon">▼</span>
                </div>
                <div class="collapsible-content" id="objects-content">
                    <div class="tool-item" draggable="true" data-type="node">
                        📦 节点
                    </div>
                    <div class="tool-item" draggable="true" data-type="connection">
                        🔗 连线
                    </div>
                    <div class="tool-item" draggable="true" data-type="text">
                        📝 文字
                    </div>
                </div>
            </div>
            
            <div class="tool-panel-resizer" id="tool-panel-resizer"></div>
        </aside>

        <!-- 中间工作区 -->
        <section class="workspace">
            <canvas id="editor-canvas"></canvas>
            <div class="selection-rectangle hidden"></div>
            <div class="workspace-resizer" id="workspace-resizer"></div>
        </section>

        <!-- 右侧属性栏 -->
        <aside class="property-panel">
            <!-- 新的动态属性面板容器 -->
            <div id="property-panel-container"></div>
        </aside>
    </div>

    <!-- 底部状态栏 -->
    <footer class="status-bar">
        <div class="status-info">
            <span id="status-text">就绪</span>
            <span class="status-separator">|</span>
            <span id="force-simulation-status" class="force-status hidden">正在进行力学模拟！</span>
        </div>
        <div class="status-stats">
            <span id="node-count">节点: 0</span>
            <span class="status-separator">|</span>
            <span id="connection-count">连接: 0</span>
            <span class="status-separator">|</span>
            <span id="selection-info">选中: 0</span>
        </div>
        <div class="zoom-controls">
            <button id="zoom-out">-</button>
            <span id="zoom-level">100%</span>
            <button id="zoom-in">+</button>
        </div>
    </footer>

    <!-- 隐藏的文件输入，用于导入Markdown -->
    <input type="file" id="file-input" accept=".md" style="display: none;">
    <!-- 隐藏的文件输入，用于导入JSON -->
    <input type="file" id="json-input" accept=".json" style="display: none;">
    <!-- 隐藏的文件输入，用于导入YAML -->
    <input type="file" id="yaml-input" accept=".yaml,.yml" style="display: none;">
    <!-- 隐藏的文件输入，用于打开工程文件 -->
    <input type="file" id="project-input" accept=".json" style="display: none;">

    <script type="module" src="../src/main.js"></script>
</body>

</html>