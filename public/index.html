<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>节点图形化编辑器</title>
    <link rel="stylesheet" href="./assets/styles/global.css">
</head>

<body>
    <!-- 顶部菜单栏 -->
    <div class="menu-bar">
        <div class="menu-group">
            <button id="new-project">新建</button>
            <button id="open-project">打开</button>
            <button id="import-md">导入</button>
            <div class="export-submenu">
                <button id="export-menu">导出</button>
                <div class="export-submenu-content">
                    <button id="export-md">导出Markdown</button>
                    <button id="export-image">导出为位图</button>
                </div>
            </div>
            <button id="save-project">保存</button>
            <select id="selection-filter" class="selection-filter">
                <option value="all">选择所有对象</option>
                <option value="nodes">仅选择节点</option>
                <option value="connections">仅选择连线</option>
            </select>
        </div>
        <div class="menu-group">
            <button id="undo">撤销</button>
            <button id="redo">重做</button>
            <button id="toggle-theme">切换主题</button>
        </div>
    </div>

    <!-- 主内容区 -->
    <div class="main-content">
        <!-- 左侧工具栏 -->
        <aside class="tool-panel">
            <!-- 工具栏（上方） -->
            <div class="toolbar-section">
                <h4 class="toolbar-title">工具</h4>
                <button id="merge-nodes-btn" class="toolbar-btn">合并节点</button>
                <button id="merge-conditions-btn" class="toolbar-btn">合并条件</button>
            </div>
            <!-- 纵向分隔线 -->
            <div class="toolbar-resizer" id="toolbar-resizer"></div>
            <!-- 对象栏（下方） -->
            <div class="object-section">
                <h4 class="toolbar-title">对象</h4>
                <div class="tool-item" draggable="true" data-type="node">
                    📦 节点
                </div>
                <div class="tool-item" draggable="true" data-type="connection">
                    🔗 连线
                </div>
            </div>
            <div class="tool-panel-resizer" id="tool-panel-resizer"></div>
        </aside>

        <!-- 中间工作区 -->
        <section class="workspace">
            <canvas id="editor-canvas"></canvas>
            <div class="selection-rectangle hidden"></div>
            <div class="workspace-resizer" id="workspace-resizer"></div>
        </section>

        <!-- 右侧属性栏 -->
        <aside class="property-panel">
            <div id="node-properties" class="property-section hidden">
                <h3>节点属性</h3>
                <div class="form-group">
                    <label for="node-name">节点名称</label>
                    <input type="text" id="node-name">
                </div>
                <div class="form-group">
                    <label for="node-description">节点描述</label>
                    <textarea id="node-description"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="node-color">节点颜色</label>
                    <input type="color" id="node-color" class="selector-color-picker" value="#ffffff">
                    <button id="node-color-reset" class="btn-small">重置为默认</button>
                </div>

                <div class="form-group">
                    <label>尺寸设置</label>
                    <div class="checkbox-group">
                        <input type="checkbox" id="node-autosize">
                        <label for="node-autosize">自适应内容尺寸</label>
                    </div>
                </div>

                <div class="form-group dimension-inputs">
                    <div>
                        <label for="node-width">宽度</label>
                        <input type="number" id="node-width" min="50" max="500" value="150">
                    </div>
                    <div>
                        <label for="node-height">高度</label>
                        <input type="number" id="node-height" min="30" max="300" value="50">
                    </div>
                </div>

                <button id="update-node" class="btn">更新节点</button>
                <button id="delete-node" class="btn btn-danger">删除节点</button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <h4>连线信息</h4>
                    <div class="connection-list-section">
                        <div class="connection-list-group">
                            <label>出发的连线</label>
                            <div id="outgoing-connections" class="connection-list"></div>
                        </div>
                        <div class="connection-list-group">
                            <label>到达的连线</label>
                            <div id="incoming-connections" class="connection-list"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="connection-properties" class="property-section hidden">
                <h3>连线属性</h3>
                
                <div class="form-group">
                    <label for="connection-color">连线颜色</label>
                    <input type="color" id="connection-color" value="#666666">
                    <button id="connection-color-reset" class="btn-small">重置为默认</button>
                </div>
                
                <div class="form-group">
                    <label for="connection-line-width">连线粗细</label>
                    <input type="number" id="connection-line-width" min="0.5" max="10" step="0.5" value="1.5">
                    <button id="connection-line-width-reset" class="btn-small">重置为默认</button>
                </div>
                
                <div class="form-group">
                    <label for="connection-line-type">连线类型</label>
                    <select id="connection-line-type">
                        <option value="solid">连续线</option>
                        <option value="dashed">间隔线</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="connection-arrow-size">箭头尺寸</label>
                    <input type="number" id="connection-arrow-size" min="5" max="30" step="1" value="15">
                    <button id="connection-arrow-size-reset" class="btn-small">重置为默认</button>
                </div>
                
                <div class="form-group">
                    <label for="connection-arrow-color">箭头颜色</label>
                    <input type="color" id="connection-arrow-color" value="#888888">
                    <button id="connection-arrow-color-reset" class="btn-small">重置为默认</button>
                </div>
                
                <h4 style="margin-top: 20px;">连线条件</h4>
                <div id="conditions-list">
                    <!-- 条件项将通过JavaScript动态添加 -->
                </div>
                <button id="add-condition" class="btn">添加条件</button>
                <button id="delete-connection" class="btn btn-danger">删除连线</button>
            </div>

            <div id="no-selection" class="property-section">
                <h3>提示</h3>
                <p>选择节点或连线以编辑其属性</p>
            </div>
        </aside>
    </div>

    <!-- 底部状态栏 -->
    <footer class="status-bar">
        <div class="status-info">就绪</div>
        <div class="zoom-controls">
            <button id="zoom-out">-</button>
            <span id="zoom-level">100%</span>
            <button id="zoom-in">+</button>
        </div>
    </footer>

    <!-- 隐藏的文件输入，用于导入Markdown -->
    <input type="file" id="file-input" accept=".md" style="display: none;">
    <!-- 隐藏的文件输入，用于打开工程文件 -->
    <input type="file" id="project-input" accept=".json" style="display: none;">

    <script type="module" src="../src/main.js"></script>
</body>

</html>